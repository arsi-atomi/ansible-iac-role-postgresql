---
servers:
  hosts:
    host.example.org:
  vars:
    iac_blueprint:
      postgresql:
        - version: 17
          directories:
            - path: /var/lib/pgsql/backups
              owner: postgres
              group: postgres
              mode: "0750"
          files:
            - path: /etc/pgsql/backup.env
              content: "PGUSER=postgres\n"
              owner: root
              group: root
              mode: "0640"
          cron:
            - name: pg_backup
              user: postgres
              minute: "0"
              hour: "2"
              job: "/usr/local/bin/pg_backup"
              cron_file: pg_backup
          instances:
            - name: data
              databases:
                - name: mydatabase
                  owner: myadmin
                  extensions:
                    - name: pgaudit
                    - name: citus
                    - name: postgis35
                  access:
                    - name: myuser
                      address: 10.89.0.1/32
                      type: host
                      method: scram-sha-256
              roles:
                - name: myuser
                  password: jepujee!
                  createdb: true
                - name: myadmin
                  encrypted_password: >-
                    SCRAM-SHA-256$4096:1RVfuKXwkdIH5E6/8Faygg==$W3D8X+mL1u72cgysrW1Es88blE7jsUzxDB9MV1sIHrs=:9c1enL1YEr2tLkdmmtNVydhDf/a7PHPvzsnkWOa4HHw=
                  createuser: false
              configuration_profile: balanced
              autotuning_profile: balanced
              security_profile: safe
              configuration:
                max_connections: 50
                shared_preload_libraries: citus,pgaudit
